{% extends 'layout.html'%}

{% block body %}

  <style>
      .form-popup {
    display: none;
    position: fixed;
    bottom: 0;
    right: 15px;
    border: 3px solid #f1f1f1;
    z-index: 9;
  }
  
  /* Add styles to the form container */
  .form-container {
    max-width: 300px;
    padding: 10px;
    background-color: white;
  }
  
  /* Full-width input fields */
  .form-container input[type=text], .form-container input[type=password] {
    width: 100%;
    padding: 15px;
    margin: 5px 0 22px 0;
    border: none;
    background: #f1f1f1;
  }
  
  /* When the inputs get focus, do something */
  .form-container input[type=text]:focus, .form-container input[type=password]:focus {
    background-color: #ddd;
    outline: none;
  }
  
  /* Set a style for the submit/login button */
  .form-container .btn {
    background-color: #4CAF50;
    color: white;
    padding: 16px 20px;
    border: none;
    cursor: pointer;
    width: 100%;
    margin-bottom:10px;
    opacity: 0.8;
  }
  
  /* Add a red background color to the cancel button */
  .form-container .cancel {
    background-color: red;
  }
  
  /* Add some hover effects to buttons */
  .form-container .btn:hover, .open-button:hover {
    opacity: 1;
  }
  </style>
  <br /> <br /> <br /> <br /> 
  <table class="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Item</th>
        <th scope="col">Owner</th>
        <th scope="col">Quantity</th>
        <th scope="col">Price</th>
        <th scope="col">Description</th>
      </tr>
    </thead>
    <tbody>
        {% for i in table: %}
          <tr>
            <th scope="row"><button type="button" class="btn btn-primary" onclick="openForm({{ i['item_id'] }})" id="{{ i['item_id'] }}x0">{{ i['item_id'] }}</button></th>
            <td id="{{ i['item_id'] }}x1">{{ i['name'] }}</td>
            <td id="{{ i['item_id'] }}x2">{{ i['user'] }}</td>
            <td id="{{ i['item_id'] }}x3">{{ i['quantity'] }}</td>
            <td id="{{ i['item_id'] }}x4">{{ i['price'] }}</td>
            <td id="{{ i['item_id'] }}x5">{{ i['description'] }}</td>
          </tr>
        {% endfor %}
    </tbody>
  </table>

  <h1>Grand Total: {{ pricesum }}</h1>

  <div class="form-popup" id="myForm" >
    <form class="form-container" action="{{ url_for('updatedb') }}" method="post">
      <h3 style="text-align: center; font-size: 16px;">Update Field</h2>

      <label for="num"><b>Item #</b></label>
      <input type="text" placeholder="Enter number" name="num" id="x0" readonly>
  
      <label for="name"><b>Item</b></label>
      <input type="text" placeholder="Enter name" name="name" id="x1" required>
  
      <label for="email"><b>Email</b></label>
      <input type="text" placeholder="Enter email" name="email" id="x2" required>

      <label for="quantity"><b>Quantity</b></label>
      <input type="text" placeholder="Enter quantity" name="quantity" id="x3" required>
      
      <label for="price"><b>Price</b></label>
      <input type="text" placeholder="Enter price" name="price" id="x4" required>

      <label for="description"><b>Description</b></label>
      <input type="text" placeholder="Enter description" name="description" id="x5" required>
  
      <button type="submit" class="btn" onclick="closeForm()">Add</button>
      <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
    </form>
  </div>

  <script>

    function openForm(x) {
      document.getElementById("myForm").style.display = "block";
      for(var i = 0; i < 6; i++) {
        var field_id = "x" + i;
        document.getElementById(field_id).value = document.getElementById(x + field_id).innerText;
        console.log(x + field_id);
      }
    }
    
    function closeForm() {
      document.getElementById("myForm").style.display = "none";
    }
  </script>
{% endblock %}